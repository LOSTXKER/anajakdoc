# üóÉÔ∏è Data Model

> **Multi-tenant**: ‡∏ó‡∏∏‡∏Å Entity ‡∏°‡∏µ `organization_id` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó

## ER Diagram Overview

```
                          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                          ‚îÇ    Organization     ‚îÇ ‚Üê ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (Multi-tenant root)
                          ‚îÇ  (‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£)    ‚îÇ
                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                     ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ                          ‚îÇ                          ‚îÇ
          ‚ñº                          ‚ñº                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      User       ‚îÇ     ‚îÇ   CostCenter    ‚îÇ     ‚îÇ    Contact      ‚îÇ
‚îÇ + org_id        ‚îÇ     ‚îÇ + org_id        ‚îÇ     ‚îÇ + org_id        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îÇ                       ‚ñº                       ‚îÇ
         ‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ         ‚îÇ                  Document                    ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  + organization_id                          ‚îÇ
                   ‚îÇ  + WHT fields + Currency fields              ‚îÇ
                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ           ‚îÇ           ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ               ‚îÇ           ‚îÇ           ‚îÇ               ‚îÇ
          ‚ñº               ‚ñº           ‚ñº           ‚ñº               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇDocumentLine  ‚îÇ ‚îÇ  Comment    ‚îÇ ‚îÇActivity ‚îÇ ‚îÇ Document ‚îÇ ‚îÇ    Claim     ‚îÇ
‚îÇ(‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢)  ‚îÇ ‚îÇ  (‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢)   ‚îÇ ‚îÇ   Log   ‚îÇ ‚îÇ Exchange ‚îÇ ‚îÇ (‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ExpenseGroup   ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ    Document     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   WHTRule       ‚îÇ
‚îÇ  + org_id       ‚îÇ     ‚îÇ                 ‚îÇ     ‚îÇ + org_id        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ InboundChannel  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ InboundMessage  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ Document (draft)
‚îÇ + org_id        ‚îÇ     ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 3.0 Organization (‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£) ‚Äî Multi-tenant Root

> Entity ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Multi-tenant: ‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ |
| `slug` | string | URL-friendly identifier (unique) |
| `tax_id` | string | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ |
| `address` | text | ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà |
| `phone` | string | ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå |
| `email` | string | ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ |
| `logo_url` | string | ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó |
| `settings` | JSON | ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ (default VAT, fiscal year start, etc.) |
| `plan` | enum | free \| pro \| enterprise (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö billing) |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |

### Organization Settings (JSON)
```json
{
  "default_vat_type": "vat_7",
  "fiscal_year_start_month": 1,
  "default_currency": "THB",
  "doc_number_prefix": "DOC",
  "invoice_number_prefix": "INV",
  "require_approval": false,
  "allowed_file_types": ["image/jpeg", "image/png", "application/pdf"]
}
```

---

## 3.0.1 OrganizationMember (‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£)

> ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á User ‡∏Å‡∏±‡∏ö Organization (Many-to-Many + Role)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ |
| `user_id` | FK | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `role` | enum | staff \| accounting \| admin \| owner |
| `is_default` | boolean | ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á user ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà |
| `joined_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° |
| `invited_by` | FK | ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏¥‡∏ç (nullable) |
| `status` | enum | active \| pending \| suspended |

### Role Permissions

| Role | Create Doc | Review Doc | Export | Settings | Manage Users | Billing |
|------|------------|------------|--------|----------|--------------|---------|
| `staff` | ‚úÖ | ‚ùå | ‚ùå | ‚ùå | ‚ùå | ‚ùå |
| `accounting` | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| `admin` | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| `owner` | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |

### User-Organization Relationship

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      User       ‚îÇ         ‚îÇ OrganizationMember  ‚îÇ         ‚îÇ  Organization   ‚îÇ
‚îÇ                 ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ                 ‚îÇ
‚îÇ  ‡∏™‡∏°‡∏ä‡∏≤‡∏¢          ‚îÇ   1:N   ‚îÇ  role: admin        ‚îÇ   N:1   ‚îÇ  ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó A ‡∏à‡∏≥‡∏Å‡∏±‡∏î  ‚îÇ
‚îÇ                 ‚îÇ         ‚îÇ  role: staff        ‚îÇ         ‚îÇ  ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó B ‡∏à‡∏≥‡∏Å‡∏±‡∏î  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

User 1 ‡∏Ñ‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏≤‡∏¢ Organization ‡πÑ‡∏î‡πâ (‡∏î‡πâ‡∏ß‡∏¢ role ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô)
```

---

## 3.1 Document (‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å)

> ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á **‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (Expense)** ‡πÅ‡∏•‡∏∞ **‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö (Income)**

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (Multi-tenant)** |
| `doc_number` | string | ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô auto-gen: DOC-YYYYMM-XXXX |
| `transaction_type` | enum | **expense (‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢) \| income (‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö)** |
| `external_ref` | string | ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à/‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö/Invoice |
| `doc_type` | enum | slip \| receipt \| tax_invoice \| invoice \| quotation \| delivery_note \| other |
| `doc_date` | date | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ |
| `due_date` | date | ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏†‡∏≤‡∏©‡∏µ |
| `fiscal_year` | int | ‡∏õ‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡πÄ‡∏ä‡πà‡∏ô 2026 |
| `fiscal_month` | int | ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ö‡∏±‡∏ç‡∏ä‡∏µ 1-12 |
| `price_type` | enum | ‡∏£‡∏ß‡∏°‡∏†‡∏≤‡∏©‡∏µ \| ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏†‡∏≤‡∏©‡∏µ |
| `subtotal` | decimal | ‡∏¢‡∏≠‡∏î‡∏Å‡πà‡∏≠‡∏ô VAT |
| `vat_amount` | decimal | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô VAT |
| `total_amount` | decimal | ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î |
| `contact_id` | FK | ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤/‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÑ‡∏õ Contact) |
| `contact_name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤ (denormalized ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö search) |
| `payment_method` | enum | cash \| transfer \| card |
| `cost_center_id` | FK | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô |
| `internal_category_id` | FK | ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó |
| `submitted_by` | FK | ‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á |
| `status` | enum | draft \| pending_review \| need_info \| ready_to_export \| exported \| booked \| rejected \| void |
| `vat_type` | enum | vat_7 \| no_vat |
| `primary_file_id` | FK | ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å (‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÑ‡∏õ DocumentFile) |
| `extracted_json` | JSON | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å OCR |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
| `is_recurring` | boolean | ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏≥ |
| `recurring_cycle` | enum | monthly \| quarterly \| yearly |
| `expense_group_id` | FK | ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (nullable) |
| `is_primary_doc` | boolean | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô group |
| `wht_applicable` | boolean | ‡∏°‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ (Phase 2) |
| `wht_rate` | decimal | ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô 1, 3, 5 (Phase 2) |
| `wht_amount` | decimal | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ (Phase 2) |
| `claim_id` | FK | ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (Phase 2, nullable) |
| `currency` | string | ‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏ä‡πà‡∏ô THB, USD (Phase 2, default: THB) |
| `exchange_rate` | decimal | ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô (Phase 2, default: 1.0) |
| `amount_thb` | decimal | ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≤‡∏ó = total_amount √ó exchange_rate (Phase 2) |
| `inbound_message_id` | FK | ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ (Phase 2, nullable) |
| `payment_status` | enum | **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Income**: pending \| paid \| overdue \| partial (Phase 2, nullable) |
| `payment_due_date` | date | **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Income**: ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏≥‡∏£‡∏∞ (Phase 2, nullable) |
| `paid_date` | date | **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Income**: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡∏à‡∏£‡∏¥‡∏á (Phase 2, nullable) |
| `paid_amount` | decimal | **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Income**: ‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö partial payment) (Phase 2) |

---

## 3.2 DocumentFile (‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)

> ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≠ 1 ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏´‡∏•‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤, ‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á |
| `file_url` | string | URL ‡πÑ‡∏ü‡∏•‡πå |
| `file_name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö |
| `file_type` | string | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå (image/jpeg, application/pdf) |
| `file_size` | int | ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå (bytes) |
| `file_checksum` | string | ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö duplicate detection |
| `page_order` | int | ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (1, 2, 3...) |
| `is_primary` | boolean | ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á thumbnail) |
| `uploaded_by` | FK | ‡∏ú‡∏π‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î |
| `uploaded_at` | timestamp | ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î |
| `ocr_status` | enum | pending \| processing \| completed \| failed |
| `ocr_result` | JSON | ‡∏ú‡∏•‡∏à‡∏≤‡∏Å OCR (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) |

### ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
- 1 Document ‚Üí ‡∏´‡∏•‡∏≤‡∏¢ DocumentFiles
- Document.primary_file_id ‚Üí DocumentFile ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```
Document: DOC-202601-0030 (‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á)
‚îú‚îÄ‚îÄ [PRIMARY] page1.jpg (‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å - ‡πÅ‡∏™‡∏î‡∏á thumbnail)
‚îú‚îÄ‚îÄ page2.jpg (‡∏´‡∏ô‡πâ‡∏≤ 2)
‚îî‚îÄ‚îÄ page3.jpg (‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á)
```

### Duplicate Detection
- ‡∏ï‡∏£‡∏ß‡∏à `file_checksum` ‡∏ß‡πà‡∏≤‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‡∏ñ‡πâ‡∏≤‡∏ã‡πâ‡∏≥ ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô "‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ #XXX"

---

## 3.3 ExpenseGroup (‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢)

> ‡∏à‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏≤‡∏¢‡πÉ‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£** |
| `group_number` | string | ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà auto-gen: EXP-YYYYMM-XXXX |
| `title` | string | ‡∏ä‡∏∑‡πà‡∏≠/‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô "‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà" |
| `description` | text | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° |
| `contact_id` | FK | ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤/‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å |
| `cost_center_id` | FK | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô |
| `total_amount` | decimal | ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å) |
| `created_by` | FK | ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `status` | enum | open \| closed |

### ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
- 1 ExpenseGroup ‚Üí ‡∏´‡∏•‡∏≤‡∏¢ Documents
- ‡∏°‡∏µ 1 Document ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô `is_primary_doc = true` (‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å)
- Documents ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (supporting)

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```
ExpenseGroup: "‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Mac Studio"
‚îú‚îÄ‚îÄ [PRIMARY] ‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ - 45,000 ‡∏ö‡∏≤‡∏ó
‚îú‚îÄ‚îÄ ‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤
‚îú‚îÄ‚îÄ ‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
‚îî‚îÄ‚îÄ ‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á
```

---

## 3.3 DocumentLine (‡πÅ‡∏ï‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å |
| `description` | string | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ |
| `quantity` | decimal | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô |
| `unit_price` | decimal | ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ |
| `amount` | decimal | ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î |
| `vat_rate` | int | 7 \| 0 |
| `peak_account_id` | FK | ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ PEAK |

---

## 3.4 User (‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `email` | string | ‡∏≠‡∏µ‡πÄ‡∏°‡∏• |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠ |
| `avatar_url` | string | ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (optional) |
| `role` | enum | staff \| accounting \| admin |
| `department` | string | ‡πÅ‡∏ú‡∏ô‡∏Å (optional) |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `last_login_at` | timestamp | ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î |
| `notification_preferences` | JSON | ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô |
| `line_notify_token` | string | Token LINE (Phase 2) |

### Notification Preferences (JSON)
```json
{
  "channels": ["in_app", "push", "email", "line"],
  "digest_frequency": "realtime" | "daily" | "weekly"
}
```

---

## 3.5 CostCenter (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô / ‡πÅ‡∏ú‡∏ô‡∏Å)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£** |
| `code` | string | ‡∏£‡∏´‡∏±‡∏™‡∏¢‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô "CC-MKT" |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô |
| `description` | text | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (optional) |
| `parent_id` | FK | ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö nested structure (optional) |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |

---

## 3.6 InternalCategory (‡∏´‡∏°‡∏ß‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó)

> ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏π‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£** |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î |
| `description` | text | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `wht_suggestion` | enum | none \| sometimes \| usually (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ WHT) |
| `default_wht_rate` | decimal | ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (1, 3, 5 %) |

### ‡∏´‡∏°‡∏ß‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ)
| ‡∏´‡∏°‡∏ß‡∏î | ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ WHT | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|------|----------|---------|
| ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ | ‡∏ñ‡πâ‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏ó‡∏≥‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ |
| ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á / ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ | - |
| ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á / ‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ | ‡∏ñ‡πâ‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á |
| ‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö / ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ | ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á |
| ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á / ‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå | ‚úÖ ‡∏°‡∏±‡∏Å‡∏°‡∏µ | ‡∏´‡∏±‡∏Å 3% (‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•) |
| ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ | ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á |
| ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á | ‚úÖ ‡∏°‡∏±‡∏Å‡∏°‡∏µ | ‡∏´‡∏±‡∏Å 3% (‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£) |
| ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ / ‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ | ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏±‡∏Å 5% |
| ‡∏Ñ‡πà‡∏≤‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå / Subscription | ‚ö†Ô∏è ‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ | ‡∏ñ‡πâ‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ |
| ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏ï‡∏•‡πá‡∏î | ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ | - |

---

## 3.7 Vendor (‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ / ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤) ‚Äî ‚ö†Ô∏è Phase 1 Only

> **‚ö†Ô∏è Deprecated ‡πÉ‡∏ô Phase 2**: ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ `Contact` entity ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Vendor ‡πÅ‡∏•‡∏∞ Customer
> 
> ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Import/Sync ‡∏à‡∏≤‡∏Å Excel ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡πÄ‡∏ä‡πà‡∏ô PEAK Contact Export)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó |
| `vendor_type` | enum | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• \| ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• |
| `wht_applicable` | boolean | ‡∏°‡∏±‡∏Å‡∏°‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô Freelancer) |
| `default_wht_rate` | decimal | ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `tax_id_13` | string | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ 13 ‡∏´‡∏•‡∏±‡∏Å |
| `branch_no_5` | string | ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≤‡∏Ç‡∏≤ 5 ‡∏´‡∏•‡∏±‡∏Å |
| `address` | text | ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà |
| `contact_person` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ |
| `phone` | string | ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå |
| `email` | string | ‡∏≠‡∏µ‡πÄ‡∏°‡∏• |
| `default_payment_method` | enum | ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `default_cost_center_id` | FK | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `source` | enum | manual \| import |
| `external_contact_id` | string | ID ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |

> üëâ **Phase 2**: ‡∏î‡∏π [Contact (3.21)](#321-contact-‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤--‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤--phase-2) ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° Vendor + Customer

---

## 3.8 Comment (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô / ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)

> ‡πÉ‡∏ä‡πâ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡∏™‡πà‡∏á

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á |
| `user_id` | FK | ‡∏ú‡∏π‡πâ comment |
| `content` | text | ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° |
| `is_internal` | boolean | true = ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô, false = ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÄ‡∏´‡πá‡∏ô |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |

### Use Cases
- ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°: "‡πÉ‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏£‡∏±‡∏ö?"
- ‡∏Ñ‡∏ô‡∏™‡πà‡∏á‡∏ï‡∏≠‡∏ö: "‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏õ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤"
- Internal note: "‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ VAT ‡∏Å‡∏±‡∏ö‡∏™‡∏£‡∏£‡∏û‡∏≤‡∏Å‡∏£" (‡∏Ñ‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô)

---

## 3.9 ActivityLog (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)

> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å action ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (nullable - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô activity ‡∏£‡∏∞‡∏î‡∏±‡∏ö system) |
| `expense_group_id` | FK | ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (nullable) |
| `user_id` | FK | ‡∏ú‡∏π‡πâ‡∏ó‡∏≥ action |
| `action_type` | enum | created \| updated \| status_changed \| commented \| exported \| etc. |
| `action_details` | JSON | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° |
| `created_at` | timestamp | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î action |

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Activity
```
- ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ DOC-202601-0001
- ‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "Need Info"
- ‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡πÄ‡∏û‡∏¥‡πà‡∏° comment "‡∏Ç‡∏≠‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°"
- ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏ï‡∏≠‡∏ö comment "‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ FB"
- ‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "Ready to Export"
- ‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á Export ‡πÑ‡∏ü‡∏•‡πå PEAK
```

---

## 3.10 FiscalPeriod (‡∏á‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ)

> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡∏á‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `year` | int | ‡∏õ‡∏µ ‡πÄ‡∏ä‡πà‡∏ô 2026 |
| `month` | int | ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 1-12 |
| `status` | enum | open \| closing \| closed |
| `closed_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î‡∏á‡∏ß‡∏î |
| `closed_by` | FK | ‡∏ú‡∏π‡πâ‡∏õ‡∏¥‡∏î‡∏á‡∏ß‡∏î |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |

### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
| Status | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ |
|--------|----------|
| `open` | ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ |
| `closing` | ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏¥‡∏î‡∏á‡∏ß‡∏î (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¢‡∏π‡πà) |
| `closed` | ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç |

### Rules
- ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà fiscal_month ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà closed ‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
- Admin ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ reopen ‡∏á‡∏ß‡∏î‡πÑ‡∏î‡πâ (‡∏û‡∏£‡πâ‡∏≠‡∏° audit log)

---

## 3.11 SavedFilter (‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ)

> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å filter ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `user_id` | FK | ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á filter |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠ filter ‡πÄ‡∏ä‡πà‡∏ô "‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ" |
| `filter_config` | JSON | ‡πÄ‡∏Å‡πá‡∏ö criteria ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î |
| `is_shared` | boolean | true = ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÄ‡∏´‡πá‡∏ô, false = ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß |
| `is_default` | boolean | true = ‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `last_used_at` | timestamp | ‡πÉ‡∏ä‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î |

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á filter_config
```json
{
  "status": ["pending_review", "need_info"],
  "category_id": 5,
  "date_range": "this_month",
  "submitted_by": null,
  "cost_center_id": 3
}
```

---

## 3.12 ExportHistory (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ Export)

> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà export ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `exported_by` | FK | ‡∏ú‡∏π‡πâ export |
| `exported_at` | timestamp | ‡πÄ‡∏ß‡∏•‡∏≤ export |
| `export_type` | enum | excel \| peak \| zip \| pdf |
| `export_format` | enum | generic \| peak_expense \| peak_receipt |
| `filter_used` | JSON | criteria ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ export |
| `document_count` | int | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà export |
| `document_ids` | array | IDs ‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà export |
| `file_url` | string | ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå (expire ‡∏´‡∏•‡∏±‡∏á 7 ‡∏ß‡∏±‡∏ô) |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |

### Use Cases
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£ export ‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà
- Download ‡πÑ‡∏ü‡∏•‡πå export ‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô)
- ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô export ‡∏ã‡πâ‡∏≥‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à

---

## 3.13 PEAKAccount (‡∏ú‡∏±‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ PEAK)

> ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏±‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ PEAK ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ export ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `peak_account_code` | string | ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ç‡∏ä‡∏µ PEAK |
| `peak_account_name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |

---

## 3.14 CategoryAccountMapping (Mapping ‡∏´‡∏°‡∏ß‡∏î ‚Üí ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ PEAK)

> ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡πÉ‡∏´‡πâ

| Field | Type | Description |
|-------|------|-------------|
| `internal_category_id` | FK | ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó |
| `peak_account_id` | FK | ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ PEAK |
| `last_used_at` | timestamp | ‡πÉ‡∏ä‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î |

---

## 3.15 DocumentExchange (‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡πà‡∏á-‡∏£‡∏±‡∏ö) ‚Äî Phase 2

> ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å (‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ù‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠) ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏≤‡∏¢)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à/Invoice) |
| `exchange_type` | enum | outgoing (‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å) \| incoming (‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤) |
| `doc_type` | enum | wht_cert (‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢) \| tax_invoice \| receipt \| other |
| `counterparty_name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤ (vendor/customer) |
| `counterparty_contact` | string | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (email/phone) |
| `amount` | decimal | ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á |
| `wht_amount` | decimal | ‡∏¢‡∏≠‡∏î‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) |
| `status` | enum | pending \| issued \| sent \| confirmed \| received \| cancelled |
| `issued_date` | date | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ |
| `sent_date` | date | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á |
| `sent_method` | enum | email \| mail \| hand_delivery \| other |
| `confirmed_date` | date | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏µ‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö |
| `received_date` | date | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö (‡∏ù‡∏±‡πà‡∏á incoming) |
| `file_url` | string | ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) |
| `tracking_notes` | text | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° |
| `created_by` | FK | ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `updated_at` | timestamp | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î |

### Exchange Types
| Type | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á |
|------|----------|---------|
| `outgoing` | ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤ | ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ vendor |
| `incoming` | ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤ | ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤ |

### Status Flow

**Outgoing (‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å):**
```
pending ‚Üí issued ‚Üí sent ‚Üí confirmed
(‡∏£‡∏≠‡∏≠‡∏≠‡∏Å)  (‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß) (‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß) (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö)
```

**Incoming (‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤):**
```
pending ‚Üí received
(‡∏£‡∏≠‡∏£‡∏±‡∏ö)   (‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß)
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
```
‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£: ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á Freelancer ‡∏ø10,000 (‡∏´‡∏±‡∏Å 3% = ‡∏ø300)
‚îú‚îÄ‚îÄ Document: ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á
‚îî‚îÄ‚îÄ DocumentExchange:
    ‚îú‚îÄ‚îÄ type: outgoing
    ‚îú‚îÄ‚îÄ doc_type: wht_cert
    ‚îú‚îÄ‚îÄ counterparty: ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢
    ‚îú‚îÄ‚îÄ wht_amount: ‡∏ø300
    ‚îú‚îÄ‚îÄ status: sent
    ‚îú‚îÄ‚îÄ sent_date: 15 ‡∏°.‡∏Ñ. 2026
    ‚îî‚îÄ‚îÄ sent_method: email
```

---

## 3.16 Tag (‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö) ‚Äî Phase 2

> ‡∏ï‡∏¥‡∏î tag ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡∏≠‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏´‡∏°‡∏ß‡∏î

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠ tag |
| `color` | string | hex color |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |

---

## 3.17 DocumentTag (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Document ‚Üî Tag) ‚Äî Phase 2

| Field | Type | Description |
|-------|------|-------------|
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ |
| `tag_id` | FK | Tag |

---

## 3.18 Attachment (‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°) ‚Äî Phase 2

> ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (memo, contract, email)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å |
| `file_url` | string | URL ‡πÑ‡∏ü‡∏•‡πå |
| `file_name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå |
| `file_type` | string | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå |
| `file_size` | int | ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå (bytes) |
| `uploaded_by` | FK | ‡∏ú‡∏π‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î |
| `uploaded_at` | timestamp | ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |

---

## 3.19 Claim (‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô) ‚Äî Phase 2

> ‡∏£‡∏ß‡∏°‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å ‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏õ‡∏ó‡∏£‡∏¥‡∏õ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `claim_number` | string | ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà auto-gen: CLM-YYYYMM-XXXX |
| `title` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å ‡πÄ‡∏ä‡πà‡∏ô "‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û-‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà" |
| `description` | text | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° |
| `claimant_id` | FK | ‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å (User) |
| `cost_center_id` | FK | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô |
| `total_gross` | decimal | ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å |
| `total_wht` | decimal | ‡∏¢‡∏≠‡∏î WHT ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î |
| `total_reimburse` | decimal | ‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô (total_gross - total_wht) |
| `status` | enum | draft \| submitted \| approved \| rejected \| reimbursed |
| `submitted_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å |
| `approved_by` | FK | ‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ |
| `approved_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ |
| `reimbursed_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏∑‡∏ô |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |
| `updated_at` | timestamp | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î |

### ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
- 1 Claim ‚Üí ‡∏´‡∏•‡∏≤‡∏¢ Documents (‡∏ú‡πà‡∏≤‡∏ô `Document.claim_id`)
- ‡∏¢‡∏≠‡∏î `total_gross` = SUM(Document.total_amount) ‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô Claim
- ‡∏¢‡∏≠‡∏î `total_wht` = SUM(Document.wht_amount) ‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ô Claim

### Status Flow
```
draft ‚Üí submitted ‚Üí approved ‚Üí reimbursed
                 ‚Üò rejected
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```
Claim: "‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û-‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà"
‚îú‚îÄ‚îÄ ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô ‡∏ø3,500
‚îú‚îÄ‚îÄ ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡πà‡∏≤‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏° ‡∏ø2,400
‚îú‚îÄ‚îÄ ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡πà‡∏≤‡πÅ‡∏ó‡πá‡∏Å‡∏ã‡∏µ‡πà ‡∏ø350
‚îî‚îÄ‚îÄ ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ ‡∏ø1,000 (WHT 3% = ‡∏ø30)

total_gross: ‡∏ø7,250
total_wht: ‡∏ø30
total_reimburse: ‡∏ø7,220
```

---

## 3.20 WHTRule (‡∏Å‡∏é‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢) ‚Äî Phase 2

> ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏é‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ WHT ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£** |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏é ‡πÄ‡∏ä‡πà‡∏ô "‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á Freelancer" |
| `internal_category_id` | FK | ‡∏´‡∏°‡∏ß‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (nullable) |
| `contact_type` | enum | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• \| ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• \| any |
| `contact_role` | enum | vendor \| customer \| any |
| `wht_rate` | decimal | ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (1, 3, 5%) |
| `priority` | int | ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (1 = ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î) |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏é
| Name | Category | Contact Type | Rate | Priority |
|------|----------|--------------|------|----------|
| ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á Freelancer | ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á/‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | 3% | 1 |
| ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ | ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | 3% | 2 |
| ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ | ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ | any | 5% | 3 |
| ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ | ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | 2% | 4 |

### ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
1. ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Staff ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î + Vendor
2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡∏Å‡∏é‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö category + contact_type
3. ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° priority ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏≤‡∏Å‡∏é‡πÅ‡∏£‡∏Å‡∏°‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
4. **Staff ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à** ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î WHT ‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

---

## 3.21 Contact (‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ - ‡∏£‡∏ß‡∏° Vendor + Customer) ‚Äî Phase 2

> ‡∏£‡∏ß‡∏° Vendor ‡πÅ‡∏•‡∏∞ Customer ‡πÄ‡∏õ‡πá‡∏ô entity ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ù‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏≤‡∏¢

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£** |
| `name` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏£‡πâ‡∏≤‡∏ô/‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• |
| `contact_type` | enum | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• \| ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• |
| `contact_role` | enum | vendor \| customer \| both |
| `tax_id_13` | string | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ 13 ‡∏´‡∏•‡∏±‡∏Å |
| `branch_no_5` | string | ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≤‡∏Ç‡∏≤ 5 ‡∏´‡∏•‡∏±‡∏Å |
| `address` | text | ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà |
| `contact_person` | string | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ |
| `phone` | string | ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå |
| `email` | string | ‡∏≠‡∏µ‡πÄ‡∏°‡∏• |
| `wht_applicable` | boolean | ‡∏°‡∏±‡∏Å‡∏°‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ |
| `default_wht_rate` | decimal | ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `default_payment_method` | enum | ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `default_cost_center_id` | FK | ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `source` | enum | manual \| import |
| `external_contact_id` | string | ID ‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô |
| `notes` | text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |

### contact_role
| Role | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ | ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
|------|----------|--------|
| `vendor` | ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤‡∏ù‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | ‡πÄ‡∏£‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á/‡∏à‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡∏≤ |
| `customer` | ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏≤‡∏¢ | ‡πÄ‡∏Ç‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á/‡∏à‡πâ‡∏≤‡∏á‡πÄ‡∏£‡∏≤ |
| `both` | ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡∏±‡πà‡∏á | ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ |

### Migration ‡∏à‡∏≤‡∏Å Vendor
```
-- Phase 2: Migrate Vendor ‚Üí Contact
INSERT INTO contacts (id, name, contact_type, contact_role, ...)
SELECT id, vendor_name, vendor_type, 'vendor', ...
FROM vendors;

-- Update Document to use contact_id
ALTER TABLE documents ADD COLUMN contact_id UUID REFERENCES contacts(id);
UPDATE documents SET contact_id = vendor_id;
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```
Contact: "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ABC ‡∏à‡∏≥‡∏Å‡∏±‡∏î"
‚îú‚îÄ‚îÄ role: both
‚îú‚îÄ‚îÄ type: ‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
‚îú‚îÄ‚îÄ ‡πÄ‡∏£‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏Ç‡∏≤ (vendor)
‚îî‚îÄ‚îÄ ‡πÄ‡∏Ç‡∏≤‡∏Å‡πá‡∏à‡πâ‡∏≤‡∏á‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (customer)
```

---

## 3.22 InboundChannel (‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£) ‚Äî Phase 2

> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô Email Forward / LINE Forward

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `organization_id` | FK | **‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£** |
| `channel_type` | enum | email \| line |
| `channel_address` | string | Email address ‡∏´‡∏£‡∏∑‡∏≠ LINE OA ID |
| `is_active` | boolean | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| `default_submitter_id` | FK | ‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á) |
| `created_at` | timestamp | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á |

### InboundMessage (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤)

| Field | Type | Description |
|-------|------|-------------|
| `id` | UUID | Primary key |
| `channel_id` | FK | ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö |
| `sender_address` | string | Email/LINE ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á |
| `sender_user_id` | FK | User ‡∏ó‡∏µ‡πà match ‡∏Å‡∏±‡∏ö sender (nullable) |
| `subject` | string | ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö email) |
| `body` | text | ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° |
| `attachments` | JSON | ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö |
| `status` | enum | pending \| processed \| failed \| ignored |
| `document_id` | FK | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ (nullable) |
| `error_message` | text | ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error (‡∏ñ‡πâ‡∏≤ failed) |
| `received_at` | timestamp | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö |
| `processed_at` | timestamp | ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• |

### ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
```
1. User forward email ‡∏°‡∏≤‡∏ó‡∏µ‡πà docs@company.example.com
2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö email ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á InboundMessage
3. ‡∏´‡∏≤ User ‡∏à‡∏≤‡∏Å sender email
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Document (draft) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö
5. ‡∏™‡πà‡∏á notification ‡πÉ‡∏´‡πâ User ‡πÑ‡∏õ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°
```
